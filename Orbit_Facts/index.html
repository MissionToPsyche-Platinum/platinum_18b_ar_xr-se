<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psyche 16 Orbit Simulation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <style>
        body {
            margin: 0;
            background: radial-gradient(circle at center, #000010 0%, #000000 100%);
            overflow: hidden;
            height: 100vh;
        }

        .space {
            position: relative;
            width: 100vw;
            height: 90vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .sun {
            position: absolute;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, #ffec8b, #f4c542, #e69500);
            border-radius: 50%;
            box-shadow: 0 0 80px 30px rgba(255, 200, 50, 0.6);
            z-index: 1;
        }

        .orbit {
            position: absolute;
            width: 600px;
            height: 600px;
            border: 1px dashed rgba(255, 255, 255, 0.2);
            border-radius: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 0;
        }

        #three-container {
            position: absolute;
            width: 1200px;
            height: 1200px;
            pointer-events: none;
            overflow: visible;
        }

        .controls {
            position: absolute;
            bottom: 30px;
            width: 100%;
            text-align: center;
            color: white;
            font-family: sans-serif;
            z-index: 10;
        }

        .info-box {
            position: absolute;
            bottom: 60px;
            width: 300px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-family: sans-serif;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-size: 14px;
            z-index: 10;
        }
    </style>
</head>
<body>
<div class="space">
    <div class="sun"></div>
    <div class="orbit">
        <div id="three-container"></div>
    </div>
</div>
<div class="info-box" id="infoBox">Fun Fact: Psyche has an axial tilt of approximately 98°, leading to extreme seasonal variations!</div>
<div class="controls">
    <input type="range" id="orbitSlider" min="0" max="360" value="0" step="1">
</div>

<script>
    const slider = document.querySelector('#orbitSlider');
    const infoBox = document.querySelector('#infoBox');
    const container = document.getElementById('three-container');
    const radius = 233; // Adjusted for larger container

    // Three.js setup
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(50, 1, 0.1, 2000);
    camera.position.z = 1000;

    const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
    renderer.setSize(1200, 1200);
    container.appendChild(renderer.domElement);

    // Create a cube to represent Psyche (placeholder)
    let psycheModel = null;

    const geometry = new THREE.BoxGeometry(30, 30, 30);
    const material = new THREE.MeshPhongMaterial({
        color: 0x888888,
        shininess: 30
    });
    const cube = new THREE.Mesh(geometry, material);
    // Don't add cube to scene yet - will be replaced by GLTF
    psycheModel = cube;

    // Add lighting
    const ambientLight = new THREE.AmbientLight(0x404040, 2);
    scene.add(ambientLight);

    const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
    directionalLight.position.set(0, 0, 50);
    scene.add(directionalLight);

    // Load GLTF model to replace cube
    const loader = new THREE.GLTFLoader();
    loader.load(
        './models/psyche/scene.gltf',
        function(gltf) {
            const model = gltf.scene;
            model.scale.set(10000, 10000, 10000); // Size of the sun
            psycheModel = model;
            scene.add(model);

            // Set initial position based on slider
            const currentAngle = parseFloat(slider.value);
            updatePosition(currentAngle);

            console.log('GLTF model loaded and orbiting!');
        },
        function(xhr) {
            console.log((xhr.loaded / xhr.total * 100) + '% loaded');
        },
        function(error) {
            console.error('Error loading GLTF:', error);
        }
    );

    // Fun facts about seasons on 16 Psyche
    const facts = [
        {
            range: [0, 90],
            text: "Psyche's axial tilt of ~98° causes extreme seasons, where poles face the Sun directly during parts of the orbit."
        },
        {
            range: [90, 180],
            text: "Due to the high tilt, one pole experiences continuous sunlight for about 2.5 Earth years, mimicking a 2.5 year long summer day."
        },
        {
            range: [180, 270],
            text: "The opposite pole endures darkness for the same duration, resulting in a long 'winter' night."
        },
        {
            range: [270, 360],
            text: "The rapid 4.2-hour rotation means the asteroid rotates over 10,000 times per orbit."
        }
    ];

    function updatePosition(angle) {
        const rad = angle * Math.PI / 180;
        const x = Math.cos(rad) * radius;
        const y = Math.sin(rad) * radius;

        // Move the model along the orbit
        if (psycheModel) {
            psycheModel.position.x = x;
            psycheModel.position.y = -y;

            // Rotate the model (spin)
            const spin = angle * 4;
            psycheModel.rotation.x = spin * Math.PI / 180;
            psycheModel.rotation.y = spin * Math.PI / 180;
        }

        // Update fun fact based on angle
        let currentFact = facts[0].text;
        for (const fact of facts) {
            if (angle >= fact.range[0] && angle < fact.range[1]) {
                currentFact = fact.text;
                break;
            }
        }
        infoBox.textContent = `Fun Fact: ${currentFact}`;

        renderer.render(scene, camera);
    }

    // Update position when slider changes
    slider.addEventListener('input', () => {
        const angle = parseFloat(slider.value);
        updatePosition(angle);
    });

    // Initialize position
    updatePosition(0);
</script>

</body>
</html>